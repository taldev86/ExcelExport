<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
    <script src="Scripts/jquery.battatech.excelexport.js"></script>
</head>
<body>
    <div id="dvxml">
    </div>
    <div>
        <button id="btnExport">Export</button>
    </div>
</body>
</html>
<script>
    $(document).ready(function () {
        $("#btnExport").click(function () {
            var dataobj;

            $.ajax({
                type: "GET"
                , async: false
                , url: "jqgrid.xml"
                , dataType: "xml"
                , success: function (data) {
                    dataobj = data;
                }
                , error: function (xhr, ajaxOptions, thrownError) {
                }
            });

            $("#dvxml").btechco_excelexport({
                containerid: "dvxml"
                , datatype: $datatype.JqGrid
                , dataset: dataobj
                , columns: [
                    { headertext: "S.No.", datatype: "number", datafield: "id", ishidden: false }
                    , { headertext: "First Name", datatype: "string", datafield: "fname", width: "100px" }
                    , { headertext: "Last Name", datatype: "string", datafield: "lname", ishidden: false, width: "100px" }
                    , { headertext: "Username", datatype: "string", datafield: "uname", ishidden: true }
                    , { headertext: "Date", datatype: "date", format: "xxxx,xx", datafield: "dt", ishidden: false, width: "150px" }
                ]
            });
        });
    });
</script>
